---
title:  "Thinking about Models"
type:   content
---

# Data

For today's class let's move to working with a slightly larger data set; we'll use the `nycflights13` package that contains information about every flight that departed from New York City in 2013.  We'll also use `dplyr` and `ggplot2` today.

```{r}
library(nycflights13)
library(dplyr)
library(ggplot2)
```

Take a look at the `flights` table.

# Thinking about models

Over the last couple of weeks we've made a number of visualizations, making quantitative-categorical and quantitative-quantitative comparisons using histograms, density distributions, box plots, bar graphs and scatter plots.  Embedded in each of these plots was an implicit question/hypothesis and mental model of how the comparison being visualized relates to that question/hypothesis.  If you take one thing away from this course, it's that I hope you learn to think explicitly about that relationship!

# Are delays worse for some airlines?

What kind of model(s), and visualization(s), could address this question?

One option would be to model average departure delay by airline (a continuous-categorical comparison).  `dplyr` has two functions that make it easy to do that `group_by` and the `summarize` function.

```{r}
flights %>% 
  group_by(carrier) %>% 
  summarise(ave_delay = mean(dep_delay, na.rm = TRUE))
```

Take a moment to test and see what happens if you leave out the `na.rm = TRUE` call.  Why?

We can visualize our model:

```{r}
flights %>% 
  group_by(carrier) %>% 
  summarise(ave_delay = mean(!is.na(dep_delay))) %>%
  ggplot(aes(carrier, ave_delay)) + geom_bar(stat = 'identity')
```

Not terribly informative.  Why?

Let's try a new model:  the distribution of departure delays by airline.

```{r}
flights %>%
  ggplot(aes(dep_delay, fill = carrier)) + geom_density(alpha = 0.5)
```

Do we now understand why the averages weren't useful?

Let's refine our model:  the distribution of departure delays > 10 minutes.

```{r}
flights %>%
  filter(dep_delay > 60) %>%
  ggplot(aes(dep_delay, fill = carrier)) + geom_density(alpha = 0.5)
```

It's looking like Hawain Airlines had some problems!

*Hint:* See the `airlines` table to see the full names of each carrier.

# Make some models

For the rest of class today, use these tools, what you learned in the last class, and the plots featured in the reading to make some more models.

Include answers to these questions:

* Is there a relationship between origin/destination airport and delay time?
* How about for arrival times?
* Does the length of the flight affect delays on either end?
* Does time of day?
* Do some airlines make more use of some airports (*note*: categorical-categorical!)

In the last 15 minutes of class we'll look over different people's proposed models and visualizations together!
